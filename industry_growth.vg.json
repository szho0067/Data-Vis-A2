{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "data": {
    "url": "https://raw.githubusercontent.com/szho0067/Data-Vis-A2/refs/heads/main/Data%20A2/industry_growth_average.csv"
  },
  "params": [
    {
      "name": "startYear",
      "value": 2004,
      "bind": {
        "input": "range",
        "min": 2004,
        "max": 2024,
        "step": 1
      }
    },
    {
      "name": "endYear",
      "value": 2022,
      "bind": {
        "input": "range",
        "min": 2004,
        "max": 2024,
        "step": 1
      }
    }
  ],
  "transform": [
    {
      "filter": "(year(datum.Date) >= startYear) && (year(datum.Date) <= endYear)"
    }
  ],
  "layer": [
    {
      "mark": "line",
      "encoding": {
        "x": {
          "field": "Date",
          "type": "temporal",
          "title": "Year"
        },
        "y": {
          "field": "Average_Employed",
          "type": "quantitative",
          "title": "Average Employed"
        },
        "color": {
          "field": "Industry",
          "type": "nominal",
          "title": "Industry"
        },
        "tooltip": [
          {"field": "Date", "type": "temporal", "title": "Year"},
          {"field": "Industry", "type": "nominal", "title": "Industry"},
          {"field": "Average_Employed", "type": "quantitative", "title": "Number of People Employed"}
        ]
      }
    },
    {
      "mark": {
        "type": "text",
        "align": "left",
        "baseline": "middle",
        "dx": 60,
        "dy": -90,
        "fontStyle": "italic",
        "fontSize": 8
      },
      "transform": [
        {
          "filter": "datum.Industry === 'Health Care and Social Assistance'"
        },
        {
          "aggregate": [{"op": "argmax", "field": "Average_Employed", "as": "max_point"}],
          "groupby": ["Industry"]
        }
      ],
      "encoding": {
        "x": {
          "field": "max_point.Date",
          "type": "temporal"
        },
        "y": {
          "field": "max_point.Average_Employed",
          "type": "quantitative"
        },
        "text": {
          "value": "Health Care and Social Assistance"
        }
      }
    }
  ]
}
