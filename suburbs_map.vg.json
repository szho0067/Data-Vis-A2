{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "title": "Number of Jobs per Square Kilometer within the State",
  "width": 600,
  "height": 600,
  "background": "#e3f1fe",
  "data": {
    "url": "https://raw.githubusercontent.com/szho0067/Data-Vis-A2/refs/heads/main/Data%20A2/SA2_data.csv"
  },
  "transform": [
    {
      "lookup": "SA2",
      "from": {
        "data": {
          "url": "https://raw.githubusercontent.com/szho0067/Data-Vis-A2/refs/heads/main/js/SA2_map.json",
          "format": {
            "type": "topojson",
            "feature": "SA2_2021_AUST_GDA2020"
          }
        },
        "key": "properties.SA2_CODE21",
        "fields": ["properties", "type", "geometry", "properties.AREASQKM21"]
      }
    },
    {
      "calculate": "(datum['Number of Jobs'] * 1000) / datum['properties.AREASQKM21']",
      "as": "Jobs_per_SQKM"
    }
  ],
  "projection": {
    "type": "equirectangular"
  },
  "mark": {
    "type": "geoshape",
    "stroke": "black",
    "strokeWidth": 0.5
  },
  "encoding": {
    "color": {
      "field": "Jobs_per_SQKM",
      "type": "quantitative",
      "title": "Jobs per Square Kilometer",
      "scale": {
        "domain": [0, 5],  
        "scheme": "reds" 
      }
    },
    "tooltip": [
      {
        "field": "SA2 NAME",
        "type": "nominal",
        "title": "Area Name"
      },
      {
        "field": "Number of Jobs",
        "type": "quantitative",
        "title": "Number of Jobs ('000)"
      },
      {
        "field": "properties.AREASQKM21",
        "type": "quantitative",
        "title": "Area (sq km)"
      },
      {
        "field": "Jobs_per_SQKM",
        "type": "quantitative",
        "title": "Jobs per Square Kilometer"
      }
    ]
  }
}
